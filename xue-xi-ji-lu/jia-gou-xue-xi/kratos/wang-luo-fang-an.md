# 网络方案

多个微服务对外暴露提供入口，存在多种方案形式

## API网关服务

使用api-server 服务，在 db 层实现对其他服务的发现并发起调用。

优点

1. 无需关注对外暴露的url子路径维护问题

缺点

1. 每次更新对外提供服务都需要更新API网关
2. api-server 如果出现异常，则无法对外提供服务
3. ws 连接实现方式复杂
4. 服务提供时候的接口/路由可能出现冲突



## API代理服务

使用 api-server 服务，根据 uri 对调用的服务进行识别，并转发到对应服务

优点

1. 解决上述对 ws 处理复杂的问题
2. 已有服务更新服务内容无需同步更新api代理
3. 无需内部实现接口调用，并对路由进行管控，避免冲突问题

缺点

1. 新增微服务需要更新 api 转发规则，可以考虑通过 configmap 实现转发规则
2. 未能解决 api-server 异常无法对外提供服务的问题



## F5转发规则

使用 f5 irule，实现 path 分 pool 方式

优点

1. 无需新建 api-server 进行转发，不需要考虑 api-server 异常情况

缺点

1. 测试环境的环境与演练、生产不一致，容易出现配置差异问题
2. 需要了解 irule 配置，其中一个微服务需要配置 irule 管理转发规则
3. 新增微服务需要更新转发规则



## ~~NodePort（不考虑）~~

所有服务都采用 NodePort 形式提供服务
