# 数据库规范

​	所有表属性变更都**必须**经过 DAMA 平台登记并操作

## 数据库设置

1. 时区 - UTC
2. 事务等级（建议）- Repeatable Read (RR)
3. 最大连接数（建议）- 500
4. 字符集 - utf8mb4

## 命名规范

1. 库名、表名、字段名必须使用小写字母并采用下划线分割
2. 库名、表名、字段名禁止超过32个字符，须见名知意
3. 库名、表名、字段名支持最多64个字符，统一规范、易于辨识以及减少传输量不要超过32
4. 库名、表名、字段名禁止使用MySQL保留关键字
5. 临时库、临时表名必须以tmp_为前缀并以日期为后缀
6. 备份库、备份表名必须以bak为前缀并以日期为后缀
7. 索引名必须以ind_作为前缀

## 索引规范

1. 单个表索引尽量少于5个
2. 单个索引列尽量少于5列
3. 主键建议
   1. 尽量不适用字符串
   2. 不适用UUID/MD5/HASH作为主键
   3. 尽量使用自增ID
4. 核心SQL优先覆盖索引
5. 禁止使用外键
6. 减少使用 not in / not like 反向查询

## SQL规范

1. 尽量考虑采用预编译
2. 避免隐式转换
3. 禁止使用 select * 
4. 避免使用子查询，能改成 join 的尽量使用 join 
5. 尽量控制单次查询 join 的表数量在5个以内
6. 禁止在 Where 语句内实现计算
7. 尽量避免使用前置%模糊搜索
8. 避免使用存储过程、EVENT、触发器
9. 建议把 BLOB 或是 TEXT 列分离到单独的扩展表中
10. 批次处理数量控制每次提交 5W ~ 10W 行
11. 评估表的数据增长情况，对于日志、流水等增长较多的表考虑是否采用分区及数据清理